/*! CCL - v0.1.0
 * http://github.com/ObjectiveSubject/ccl
 * Copyright (c) 2018; * Licensed GPLv2+ */
!function(t,e){"use strict";var i=e.document;e.CCL||(e.CCL={}),CCL.DURATION=300,CCL.BREAKPOINT_SM=500,CCL.BREAKPOINT_MD=768,CCL.BREAKPOINT_LG=1e3,CCL.BREAKPOINT_XL=1500,t(i).ready(function(){t("html").toggleClass("no-js js")})}(jQuery,this),function(){window.CCL||(window.CCL={}),CCL.reflow=function(t){return t.offsetHeight}}(),function(t,e){"use strict";function i(){var t=s.createElement("div");e(t).css({width:"100px",height:"100px",overflow:"scroll",position:"absolute",top:"-9999px"}),e("body").append(t);var i=t.offsetWidth-t.clientWidth;return e(t).remove(),i}var s=t.document;t.CCL||(t.CCL={}),CCL.getScrollWidth=i,CCL.SCROLLBARWIDTH=i()}(this,jQuery),function(t){var e=function(t,e,i){var s,o,c,n,a=0;i||(i={});var l=function(){a=!1===i.leading?0:(new Date).getTime(),s=null,n=t.apply(o,c),s||(o=c=null)},r=function(){var r=(new Date).getTime();a||!1!==i.leading||(a=r);var h=e-(r-a);return o=this,c=arguments,h<=0||h>e?(s&&(clearTimeout(s),s=null),a=r,n=t.apply(o,c),s||(o=c=null)):s||!1===i.trailing||(s=setTimeout(l,h)),n};return r.cancel=function(){clearTimeout(s),a=0,s=o=c=null},r};t.CCL||(t.CCL={}),t.CCL.throttle=e}(this),function(t,e){"use strict";var i=t.document,s=function(t){this.$el=e(t),this.$toggle=this.$el.children(".ccl-c-accordion__toggle"),this.$content=this.$el.children(".ccl-c-accordion__content"),this.init()};s.prototype.init=function(){var t=this;this.$toggle.on("click",function(e){e.preventDefault(),t.$content.slideToggle(),t.$el.toggleClass("ccl-is-open")})},e(i).ready(function(){e(".ccl-c-accordion").each(function(){new s(this)})})}(this,jQuery),function(t,e){"use strict";var i=t.document,s=CCL.DURATION,o=function(t){this.$el=t,this.target=t.parent(),this.$target=e(this.target),this.init()};o.prototype.init=function(){var t=this;t.$target.animate({opacity:0},{duration:s,complete:function(){t.$target.slideUp(s,function(){t.$target.remove()})}})},e(i).ready(function(){e(i).on("click",'[data-dismiss="alert"]',function(t){var i=e(t.target).closest('[data-dismiss="alert"]');new o(i)})})}(this,jQuery),function(t,e){"use strict";var i=t.document,s=function(t){this.$el=e(t),this.globalDefaults={mobileFirst:!0,dotsClass:"ccl-c-carousel__paging",infinite:!1,dots:!0,slidesToScroll:1,variableWidth:!0},this.init()};s.prototype.init=function(){var t=this.$el.data(),i=t.options||{};i.responsive=[],t.optionsSm&&i.responsive.push({breakpoint:CCL.BREAKPOINT_SM,settings:t.optionsSm}),t.optionsMd&&i.responsive.push({breakpoint:CCL.BREAKPOINT_MD,settings:t.optionsMd}),t.optionsLg&&i.responsive.push({breakpoint:CCL.BREAKPOINT_LG,settings:t.optionsLg}),t.optionsXl&&i.responsive.push({breakpoint:CCL.BREAKPOINT_XL,settings:t.optionsXl}),i=e.extend(this.globalDefaults,i);var s=this.$el.slick(i),o=this;s.on("beforeChange",function(t,e,i,s){o.$el.find(".slick-slide").removeClass("ccl-is-past"),o.$el.find('.slick-slide[data-slick-index="'+s+'"]').prevAll().addClass("ccl-is-past")})},e(i).ready(function(){e(".js-promo-carousel").each(function(){new s(this)})})}(this,jQuery),function(t,e){"use strict";var i=t.document,s=function(t){this.$el=e(t),this.panelOptions=e(t).find(".ccl-c-database-filter__panel"),this.nameTextbox=e(t).find('[data-control-type="textbox"]'),this.database_displayed=e(this.panelOptions).find(".ccl-c-database__displayed"),this.database_avail=e(this.panelOptions).find(".ccl-c-database__avail"),this.databaseContainer=this.$el.find(".ccl-c-database-filter__container"),this.database_count=e(t).find(".ccl-c-database-filter__count"),this.databaseReset=e(t).find(".ccl-c-database-filter--reset"),this.runTimes=0,this.init()};s.prototype.init=function(){function t(){e(".ccl-c-database-filter__panel").find("input:checked").trigger("click"),console.log(e(".ccl-c-database-filter__panel").find("input:checked")),e(i.nameTextbox).val("").trigger("keyup")}var i=this;this.$el.jplist({itemsBox:".ccl-c-database-filter__container",itemPath:".ccl-c-database",panelPath:".ccl-c-database-filter__panel",effect:"fade",duration:300,redrawCallback:function(t,e,s){if(0==i.runTimes)return void i.runTimes++;var o=e.length,c=parseInt(i.database_avail.text(),10);o>c&&(o=c),i.database_displayed.text(o),i.pulseTwice(i.database_count),i.pulseTwice(i.databaseContainer),o!=c?i.databaseReset.show():i.databaseReset.hide()}}),i.databaseReset.on("click",t)},s.prototype.pulseTwice=function(t){t.addClass("ccl-c-database-filter--on-change"),t.on("webkitAnimationEnd oanimationend msAnimationEnd animationend",function(){e(t).removeClass("ccl-c-database-filter--on-change")})},e(i).ready(function(){e(".ccl-database-filter").each(function(){new s(this)})})}(this,jQuery),function(t,e){"use strict";function i(){e(".ccl-c-dropdown, .ccl-c-dropdown__content").removeClass(c.ACTIVE),e(o.TOGGLE).attr("aria-expanded","false")}var s=t.document,o={TOGGLE:'[data-toggle="dropdown"]'},c={ACTIVE:"ccl-is-active",CONTENT:"ccl-c-dropdown__content"},n=function(t){this.$toggle=e(t),this.$parent=this.$toggle.parent();var i=this.$toggle.data("target");this.$content=e(i),this.init()};n.prototype.init=function(){var t=this;this.$toggle.click(function(e){e.preventDefault(),e.stopPropagation(),t.toggle()}),e(s).on("click",function(t){e("."+c.CONTENT+"."+c.ACTIVE).length&&i()})},n.prototype.toggle=function(){this.$toggle.hasClass(c.ACTIVE)||this.showContent()},n.prototype.showContent=function(){this.$toggle.attr("aria-expanded","true"),this.$content.addClass(c.ACTIVE),this.$parent.addClass(c.ACTIVE)},n.prototype.hideMenu=function(){this.$toggle.attr("aria-expanded","false"),this.$content.removeClass(c.ACTIVE),this.$parent.removeClass(c.ACTIVE)},e(s).ready(function(){e(o.TOGGLE).each(function(){new n(this)})})}(this,jQuery),function(t,e){"use strict";var i=t.document,s=function(t){this.$el=e(t),this.target=this.$el.data("target"),this.$target=e(this.target),this.$parentMenu=this.$el.closest(".ccl-c-menu"),this.$closeIcon=e('<i class="ccl-b-icon close" aria-hidden="true"></i>'),this.init()};s.prototype.init=function(){var t=this;this.$el.click(function(i){i.preventDefault(),t.$target.hasClass("ccl-is-active")?(t.$parentMenu.removeClass("ccl-has-active-item"),t.$el.removeClass("ccl-is-active"),t.$target.removeClass("ccl-is-active").fadeOut(CCL.DURATION),t.$closeIcon.remove()):(e(".ccl-c-menu.ccl-has-active-item").each(function(){e(this).removeClass("ccl-has-active-item").find("a.ccl-is-active").removeClass("ccl-is-active").find(".ccl-b-icon.close").remove()}),e(".ccl-c-sub-menu-container.ccl-is-active").each(function(){e(this).removeClass("ccl-is-active").fadeOut(CCL.DURATION)}),t.$parentMenu.addClass("ccl-has-active-item"),t.$target.addClass("ccl-is-active").fadeIn(CCL.DURATION),t.$closeIcon.prependTo(t.$el),CCL.reflow(t.$closeIcon[0]),t.$closeIcon.fadeIn(200),t.$el.addClass("ccl-is-active"))})},e(i).ready(function(){e(".js-toggle-header-menu").each(function(){new s(this)})})}(this,jQuery),function(t,e){"use strict";var i=t.document,s=function(t){var i=e(t);this.$el=e(t),this.target=i.data("target"),this.$target=e(this.target),this.init()};s.prototype.init=function(){var t=this;t.$el.on("click",function(s){s.preventDefault(),e(i.body).hasClass("ccl-modal-open")?t.closeModal():t.showBackdrop(function(){t.showModal()})})},s.prototype.showBackdrop=function(t){var s=i.createElement("div"),o=e(s);o.addClass("ccl-c-modal__backdrop"),o.appendTo(i.body),CCL.reflow(s),o.addClass("ccl-is-shown"),e(i.body).addClass("ccl-modal-open").css("padding-right",CCL.SCROLLBARWIDTH),t&&setTimeout(t,300)},s.prototype.showModal=function(){var t=this;t.$target.show(0,function(){t.$target.addClass("ccl-is-shown")})},s.prototype.closeModal=function(){e(".ccl-c-modal").removeClass("ccl-is-shown"),setTimeout(function(){e(".ccl-c-modal").hide(),e(".ccl-c-modal__backdrop").removeClass("ccl-is-shown"),setTimeout(function(){e(".ccl-c-modal__backdrop").remove(),e(i.body).removeClass("ccl-modal-open").css("padding-right","")},300)},300)},e(i).ready(function(){e('[data-toggle="modal"]').each(function(){new s(this)})})}(this,jQuery),function(t,e){"use strict";var i=t.document,s=[13,9,16,17,18,20,27,91,92,37,38,39,40],o=function(t){this.$el=e(t),this.$form=this.$el.find(".ccl-c-post-search__form"),this.$postType=this.$el.attr("data-search-type"),this.$input=this.$el.find("#ccl-c-post-search__input"),this.$resultsList=this.$el.find(".ccl-c-post-search__results"),this.$inputTextbox=this.$el.find(".ccl-c-post-search__textbox"),this.init()};o.prototype.init=function(){function t(s){e.contains(c.$el[0],s.target)||c.$resultsList.hide(),e(i).off("click",t)}var o,c=this;this.$input.on("keyup keypress",function(t){t.stopImmediatePropagation(),clearTimeout(o),s.indexOf(t.keyCode)>-1||(c.query=c.$input.val(),c.query=c.query.replace(/[^a-zA-Z0-9 -'.,]/g,""),o=setTimeout(function(){c.query.length>2?c.fetchPostResults(c.query):c.$resultsList.hide()},200))}).focus(function(){""!=c.$input.val()&&c.$resultsList.show()}).blur(function(s){e(i).on("click",t)}),this.$form.on("submit",function(t){t.preventDefault(),console.log(c.query),c.query.length>2?c.fetchPostResults(c.query):c.$resultsList.hide()})},o.prototype.fetchPostResults=function(t){var i=this,s={action:"retrieve_post_search_results",query:t,postType:i.$postType};i.$inputTextbox.addClass("ccl-is-loading"),e.post(searchAjax.ajaxurl,s).done(function(t){i.processPostResults(t)}).always(function(){i.$inputTextbox.removeClass("ccl-is-loading")})},o.prototype.processPostResults=function(t){var i=this,s=e.parseJSON(t),o=s.count,c=e("<ul />").addClass("ccl-c-post-search__results-ul"),n=e("<li />").addClass("ccl-c-search--close-results").append(e("<div />").addClass("ccl-c-post-search__count ccl-u-weight-bold ccl-u-faded").append(e("<i />").addClass("ccl-b-icon arrow-down")).append(e("<span />").html("&nbsp;&nbsp"+o+" found"))).append(e("<button />").addClass("ccl-b-close ccl-c-search--close__button").attr("arial-label","Close").append(e("<i />").attr("aria-hidden",!0).addClass("ccl-b-icon close ccl-u-weight-bold ccl-u-font-size-sm")));if(0==s.posts.length)return this.$resultsList.html(""),void this.$resultsList.show().append(e("<div />").addClass("ccl-u-py-nudge ccl-u-weight-bold ccl-u-faded").html("Sorry, no databases found - try another search"));this.$resultsList.html(""),c.append(n),e.each(s.posts,function(t,i){var s=e("<li />").append(e("<a />").attr({href:i.post_link,target:"_blank"}).addClass("ccl-c-database-search__result-item").html(i.post_title+(i.post_alt_name?'<div class="ccl-u-weight-normal ccl-u-ml-nudge ccl-u-font-size-sm">('+i.post_alt_name+")</div>":"")).append(e("<span />").html("Access&nbsp;&nbsp;").append(e("<i />").addClass("ccl-b-icon arrow-right").attr({"aria-hidden":!0,style:"vertical-align:middle"}))));c.append(s)}),this.$resultsList.append(c).show(),i.$responseClose=i.$el.find(".ccl-c-search--close__button"),i.$responseClose.on("click",function(t){e(i.$resultsList).is(":visible")&&i.$resultsList.hide()})},e(i).ready(function(){e(".ccl-c-post-search").each(function(){new o(this)})})}(this,jQuery),function(t,e){"use strict";var i=e(t),s=t.document,o=function(t){if(this.$el=e(t),this.$subMenus=this.$el.find(".sub-menu"),this.$scrollSpyItems=this.$el.find(".ccl-c-quick-nav__scrollspy span"),this.$searchToggle=this.$el.find(".ccl-is-search-toggle"),e("body").hasClass("admin-bar")&&"fixed"==e("#wpadminbar").css("position")){var i=e("#wpadminbar").outerHeight();this.toggleOffset=e(".ccl-c-user-nav").offset().top+e(".ccl-c-user-nav").outerHeight()-i}else this.toggleOffset=e(".ccl-c-user-nav").offset().top+e(".ccl-c-user-nav").outerHeight();this.init()};o.prototype.init=function(){this.initScroll(),this.initMenus(),this.initScrollSpy(),this.initSearch()},o.prototype.initScroll=function(){function t(){i.scrollTop()>=e.toggleOffset?e.$el.addClass("ccl-is-fixed"):e.$el.removeClass("ccl-is-fixed")}var e=this;i.scroll(CCL.throttle(t,50))},o.prototype.initMenus=function(){this.$subMenus.length&&this.$subMenus.each(function(){var t=e(this);t.siblings("a").click(function(i){if(i.stopPropagation(),i.preventDefault(),e(this).hasClass("ccl-is-active"))return e(this).removeClass("ccl-is-active ccl-u-color-school"),void t.fadeOut(250);e(".ccl-c-quick-nav__menu a.ccl-is-active").removeClass("ccl-is-active ccl-u-color-school").siblings(".sub-menu").fadeOut(250),e(this).toggleClass("ccl-is-active ccl-u-color-school"),t.fadeToggle(250)})})},o.prototype.initScrollSpy=function(){var t=this;this.$scrollSpyItems.each(function(){function s(){i.scrollTop()>=e(c).offset().top-150?(t.$scrollSpyItems.removeClass("ccl-is-active"),o.addClass("ccl-is-active")):o.removeClass("ccl-is-active")}var o=e(this),c=o.data("target");i.scroll(CCL.throttle(s,100))})},o.prototype.initSearch=function(){var t=this;this.$searchToggle.click(function(e){e.preventDefault(),t.$el.toggleClass("ccl-search-active")})},e(s).ready(function(){e(".ccl-c-quick-nav").each(function(){new o(this)})})}(this,jQuery),function(t,e){"use strict";function i(t,e,i){function s(t,i){return t[e]<i[e]?-1:t[e]>i[e]?1:0}function o(t,i){return t[e]>i[e]?-1:t[e]<i[e]?1:0}"DESC"===i?t.sort(o):t.sort(s)}var s=t.document,o=function(t){new Date;this.$el=e(t),this.$formContent=this.$el.find(".js-room-res-form-content").css({position:"relative"}),this.$formResponse=this.$el.find(".js-room-res-form-response").css({position:"absolute",top:"1rem",left:"1rem",opacity:0}),this.$formCancel=this.$el.find(".js-room-res-form-cancel"),this.$formSubmit=this.$el.find(".js-room-res-form-submit"),this.$formReload=this.$el.find(".js-room-res-form-reload"),this.roomId=this.$el.data("resource-id"),this.$dateSelect=this.$el.find(".js-room-date-select"),this.dateYmd=this.$dateSelect.val(),this.$roomSchedule=this.$el.find(".js-room-schedule"),this.$currentDurationText=this.$el.find(".js-current-duration"),this.$formNotification=e('<p class="ccl-c-alert"></p>'),this.$resetSelectionBtn=this.$el.find(".js-reset-selection"),this.$roomSlotInputs=null,this.selectedSlotInputs=[],this.maxSlots=4,this.$maxTime=this.$el.find(".js-max-time"),this.slotMinutes=30,this.locale="en-US",this.timeZone={timeZone:"America/Los_Angeles"},this.init()};o.prototype.init=function(){this.setLoading(),this.updateScheduleData(),this.setMaxTimeText(),this.initDateEvents(),this.initFormEvents()},o.prototype.getSpaceAvailability=function(t){var i={action:"get_room_info",ccl_nonce:CCL.nonce,availability:t||"",room:this.roomId};return e.post({url:CCL.ajax_url,data:i})},o.prototype.getSpaceBookings=function(t){var i={action:"get_bookings",ccl_nonce:CCL.nonce,date:t||"",room:this.roomId,limit:50};return e.post({url:CCL.ajax_url,data:i})},o.prototype.updateScheduleData=function(){var t=this.getSpaceAvailability(this.dateYmd),s=this.getSpaceBookings(this.dateYmd),o=this;e.when(t,s).done(function(t,e){var s,c=t[0],n=e[0],a=t[2],l=e[2];c="string"==typeof c?JSON.parse(c)[0]:c[0],n="string"==typeof n?JSON.parse(n):n,n.length&&(n.forEach(function(t,e){var i=new Date(t.fromDate).getTime(),s=new Date(t.toDate).getTime(),n=(s-i)/1e3/60,a=n/o.slotMinutes;c.availability.push({from:t.fromDate,to:t.toDate,slotCount:a,isBooked:!0})}),i(c.availability,"from")),s=o.parseSchedule(c.availability),o.buildSchedule(s),a.fail(function(t){console.log(t)}),l.fail(function(t){console.log(t)})}).always(function(){o.unsetLoading(),o.$resetSelectionBtn.hide()})},o.prototype.buildSchedule=function(t){var e=this,i=[];t.forEach(function(t,s){var o,c=new Date(t.from),n="";o=0!==c.getMinutes()?e.readableTime(c,"h:m"):e.readableTime(c,"ha"),t.isBooked&&t.hasOwnProperty("slotCount")&&(n="ccl-is-occupied ccl-duration-"+t.slotCount),i.push(e.buildTimeSlot({id:"slot-"+e.roomId+"-"+s,from:t.from,to:t.to,timeString:o,class:n}))}),this.selectedSlotInputs=[],this.$roomSchedule.html(i.join("")),this.$roomSlotInputs=this.$el.find('.ccl-c-room__slot [type="checkbox"]'),this.setCurrentDurationText(),this.initSlotEvents()},o.prototype.buildTimeSlot=function(t){if(!t||"object"!=typeof t)return"";var i={class:"",id:"",disabled:"",from:"",to:"",timeString:""};return t=e.extend(i,t),'<div class="ccl-c-room__slot '+t.class+'"><input type="checkbox" id="'+t.id+'" name="'+t.id+'" value="'+t.from+'" data-to="'+t.to+'" '+t.disabled+'/><label class="ccl-c-room__slot-label" for="'+t.id+'">'+t.timeString+"</label></div>"},o.prototype.parseSchedule=function(t){var e,i,s=null,o=[];return t.forEach(function(t,e){s&&s!==t.from&&o.push(e),s=t.to}),o.length>=2?(e=o[0],i=o[1]):(e=0,i=1===o.length?o[0]:t.length),t.slice(e,i)},o.prototype.initFormEvents=function(){var t=this;this.$resetSelectionBtn.click(function(i){i.preventDefault(),e(t.selectedSlotInputs).each(function(t,i){e(i).prop("checked",!1).change()}),e(".ccl-c-room__slot").removeClass("ccl-is-disabled ccl-has-potential")}),this.$el.submit(function(e){e.preventDefault(),t.onSubmit()}),this.$formReload.click(function(e){e.preventDefault(),t.reloadForm()})},o.prototype.initDateEvents=function(){var t=this;this.$dateSelect.change(function(){t.onDateChange()})},o.prototype.onDateChange=function(){this.dateYmd=this.$dateSelect.val(),this.setLoading(),this.updateScheduleData()},o.prototype.initSlotEvents=function(){var t=this;this.$roomSlotInputs&&this.$roomSlotInputs.length&&(this.$el.find(".ccl-c-room__slot").hover(function(){t.onSlotMouseIn(this)},function(){t.onSlotMouseOut(this)}),this.$roomSlotInputs.click(function(e){var i=this;t.onSlotClick(i,e)}),this.$roomSlotInputs.change(function(){var e=this;t.onSlotChange(e)}))},o.prototype.onSlotMouseIn=function(t){if(1===this.selectedSlotInputs.length){var i=e(t).find('[type="checkbox"]'),s=this.$roomSlotInputs.index(i),o=this.$roomSlotInputs.index(this.selectedSlotInputs[0]),c=[s,o].sort();if(c[0]!==c[1]&&!(c[0]<=o-this.maxSlots||c[1]>=o+this.maxSlots)){var n=this.$roomSlotInputs.eq(c[0]).parent(".ccl-c-room__slot"),a=this.$roomSlotInputs.eq(c[1]).parent(".ccl-c-room__slot");n.nextUntil(a).each(function(){var t=e(this);t.hasClass("ccl-is-disabled")||t.addClass("ccl-has-potential")})}}},o.prototype.onSlotMouseOut=function(t){1===this.selectedSlotInputs.length&&e(".ccl-c-room__slot").removeClass("ccl-has-potential")},o.prototype.onSlotClick=function(t,i){function s(){e(".ccl-c-room__slot.ccl-is-occupied").each(function(t,i){var s=e(i).find('[type="checkbox"]'),l=o.$roomSlotInputs.index(s);n<l&&l<a&&(l<c&&(n=l),l>c&&(a=l))}),o.$roomSlotInputs.each(function(t,i){(t<=n||t>=a)&&e(i).parent(".ccl-c-room__slot").addClass("ccl-is-disabled")})}var o=this,c=o.$roomSlotInputs.index(t),n=c-o.maxSlots,a=c+o.maxSlots;if(0===o.selectedSlotInputs.length&&s(),1===o.selectedSlotInputs.length&&(e(t).parent(".ccl-c-room__slot").hasClass("ccl-is-disabled")?i.preventDefault():e(".ccl-c-room__slot").removeClass("ccl-is-disabled")),o.selectedSlotInputs.length>=2){if(o.selectedSlotInputs.indexOf(t)<0)o.clearAllSlots(),o.selectedSlotInputs=[];else{i.preventDefault();var l=o.selectedSlotInputs.indexOf(t);e.extend([],o.selectedSlotInputs).forEach(function(t,e){l!=e&&o.clearSlot(t)}),o.setCurrentDurationText()}s()}},o.prototype.onSlotChange=function(t){if(e(t).prop("checked"))this.selectedSlotInputs.push(t),e(t).parent(".ccl-c-room__slot").addClass("ccl-is-checked");else{var i=this.selectedSlotInputs.indexOf(t);i>-1&&this.selectedSlotInputs.splice(i,1),e(t).parent(".ccl-c-room__slot").removeClass("ccl-is-checked")}if(this.selectedSlotInputs.length>0?this.$resetSelectionBtn.show():this.$resetSelectionBtn.hide(),2===this.selectedSlotInputs.length){var s=this;s.$el.find(".ccl-is-checked").first().nextUntil(".ccl-is-checked").each(function(t,i){var o=e(i).find('input[type="checkbox"]');s.selectedSlotInputs.push(o[0]),s.activateSlot(i)})}this.setCurrentDurationText()},o.prototype.clearSlot=function(t){var i;if(e(t).is('[type="checkbox"]'))e(t).prop("checked",!1).parent(".ccl-c-room__slot").removeClass("ccl-is-checked ccl-has-potential"),i=this.selectedSlotInputs.indexOf(t);else{var s=e(t).find('[type="checkbox"]');e(t).removeClass("ccl-is-checked ccl-has-potential"),s.prop("checked",!1),i=this.selectedSlotInputs.indexOf(s[0])}this.selectedSlotInputs.splice(i,1)},o.prototype.clearAllSlots=function(){var t=this;this.$resetSelectionBtn.hide();var i=e.extend([],t.selectedSlotInputs);e(i).each(function(e,i){t.clearSlot(i)})},o.prototype.activateSlot=function(t){var i=e(t).is('[type="checkbox"]'),s=i?e(t).parent(".ccl-c-room__slot"):e(t);s.hasClass("ccl-is-occupied")||(e(t).is('[type="checkbox"]')?(e(t).prop("checked",!0),s.addClass("ccl-is-checked")):s.addClass("ccl-is-checked").find('[type="checkbox"]').prop("checked",!0))},o.prototype.setLoading=function(){this.$currentDurationText.text("Loading schedule..."),this.$el.addClass("ccl-is-loading")},o.prototype.unsetLoading=function(){this.$el.removeClass("ccl-is-loading")},o.prototype.setCurrentDurationText=function(){var t=e.extend([],this.selectedSlotInputs),i=t.sort(function(t,e){return t.value>e.value}),s=i.length;if(s>0){var o=i[0].value,c=this.readableTime(new Date(o)),n=s>=2?i[i.length-1].value:o,a=new Date(n).getTime()+60*this.slotMinutes*1e3,l=this.readableTime(new Date(a));this.$currentDurationText.text("From "+c+" to "+l)}else this.$currentDurationText.text("Please select available time slots")},o.prototype.setMaxTimeText=function(){var t,e=this.maxSlots*this.slotMinutes;switch(e){case 240:case 180:case 120:case 60:t=e/60+" hours";break;default:t=e+"mins"}this.$maxTime.text(t)},o.prototype.readableTime=function(t,e){var i=t.toLocaleString(this.locale,this.timeZone),s=i.split(", ")[1],o=s.split(" ")[0],c={a:s.split(" ")[1].toLowerCase(),h:o.split(":")[0],m:o.split(":")[1]};if(e&&"string"==typeof e){for(var n=e.split(""),a=[],l=0;l<n.length;l++)c[n[l]]?a.push(c[n[l]]):a.push(n[l]);return a.join("")}return c.h+":"+c.m+c.a},o.prototype.onSubmit=function(t){function i(t){var i,o=JSON.parse(t);o.booking_id?i=['<p class="ccl-h2 ccl-u-mt-0">Success!</p>','<p class="ccl-h4">Your booking ID is <span class="ccl-u-color-school">'+o.booking_id+"</span></p>",'<p class="ccl-h4">Please check your email to confirm your booking.</p>']:(i=['<p class="ccl-h3 ccl-u-mt-0">Sorry, but we couldn\'t process your reservation.</p>','<p class="ccl-h4">Errors:</p>'],e(o.errors).each(function(t,e){i.push('<p class="ccl-c-alert ccl-is-error">'+e+"</p>")}),i.push('<p class="ccl-h4">Please talk to your nearest librarian for help.</p>')),s.$formCancel.prop("disabled",!1).text("Close"),s.$formSubmit.hide(),s.$formReload.show(),s.$formContent.animate({opacity:0},CCL.DURATION),s.$formResponse.delay(CCL.DURATION).animate({opacity:1},CCL.DURATION).html(i),s.$formContent.delay(CCL.DURATION).animate({height:s.$formResponse.height()+"px"},CCL.DURATION).css({zIndex:"-1"}),s.$el.removeClass("ccl-is-submitting")}if(!this.selectedSlotInputs.length)return void this.$formNotification.css("display","none").addClass("ccl-is-error").text("Please select a time for your reservation").appendTo(this.$formContent).slideDown(CCL.DURATION);this.$formNotification.remove();var s=this,o=e.extend([],this.selectedSlotInputs).sort(function(t,e){return t.value>e.value}),c=o[0].value,n=o.length>1?e(o[o.length-1]).data("to"):e(o[0]).data("to"),a={iid:333,start:c,fname:this.$el[0].fname.value,lname:this.$el[0].lname.value,email:this.$el[0].email.value,nickname:this.$el[0].nickname.value,bookings:[{id:this.roomId,to:n}]};this.$el.addClass("ccl-is-submitting"),this.$formCancel.prop("disabled",!0),this.$formSubmit.text("Sending...").prop("disabled",!0);var l={action:"request_booking",ccl_nonce:CCL.nonce,payload:a};e.post({url:CCL.ajax_url,data:l}).done(function(t){i(t)}).fail(function(t){console.log(t)}).always(function(){s.$el.removeClass("ccl-is-submitting")})},o.prototype.reloadForm=function(){this.$formCancel.text("Cancel"),this.$formSubmit.text("Submit").prop("disabled",!1).show(),this.$formReload.hide(),this.clearAllSlots(),this.$formResponse.animate({opacity:0},CCL.DURATION).delay(CCL.DURATION).html(""),this.$formContent.delay(CCL.DURATION).css({height:"",zIndex:""}).animate({opacity:1},CCL.DURATION),this.setLoading(),this.updateScheduleData()},e(s).ready(function(){e(".js-room-res-form").each(function(){new o(this)})})}(this,jQuery),function(t,e){"use strict";var i=t.document,s=function(t){this.$el=e(t),this.$slideToggleLink=this.$el.find(".ccl-c-slideToggle__title"),this.$toggleContainer=this.$el.find(".ccl-c-slideToggle__container"),this.init()};s.prototype.init=function(){var t=this;this.$slideToggleLink.on("click",function(i){i.preventDefault();var s=e(this),o=s.attr("data-toggleTitle");s.toggleClass("ccl-is-active").siblings().removeClass("ccl-is-active"),"true"===s.attr("aria-expanded")?e(s).attr("aria-expanded","false"):e(s).attr("aria-expanded","true"),t.$toggleContainer.find('[data-toggleTarget="'+o+'"]').slideToggle("fast"),"true"===t.$toggleContainer.attr("aria-expanded")?e(t.$toggleContainer).attr("aria-expanded","false"):e(t.$toggleContainer).attr("aria-expanded","true")})},e(i).ready(function(){e(".ccl-c-slideToggle").each(function(){new s(this)})})}(this,jQuery),function(t,e){"use strict";var i=t.document;e(i).ready(function(){e(".js-smooth-scroll").on("click",function(t){t.preventDefault(),e(this).blur();var i=e(this).data("target")||e(this).attr("href"),s=e(i),o=0;if(e(".ccl-c-quick-nav").each(function(){o+=e(this).outerHeight()}),s.length){var c=s.offset().top;e("html, body").animate({scrollTop:c-o},800)}})})}(this,jQuery),function(t,e){"use strict";var i=t.document,s=e(t),o={isFixed:"ccl-is-fixed"},c=function(t){function i(){s.scrollTop()+l.offset>=a.top?c.addClass(o.isFixed):c.removeClass(o.isFixed)}var c=e(t),n=c.outerHeight(),a=c.offset(),l=c.data("sticky"),r=e('<div class="js-sticky-wrapper"></div>').css({height:n+"px"}),h={offset:0};return l=e.extend(h,l),c.wrap(r),s.scroll(CCL.throttle(i,100)),this};e(i).ready(function(){e(".js-is-sticky").each(function(){new c(this)})})}(this,jQuery),function(t,e){"use strict";function i(t,e,i){var s="";if(i){var o=new Date;o.setTime(o.getTime()+24*i*60*60*1e3),s="; expires="+o.toUTCString()}c.cookie=t+"="+(e||"")+s+"; path=/"}function s(t){for(var e=t+"=",i=c.cookie.split(";"),s=0;s<i.length;s++){for(var o=i[s];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(e))return o.substring(e.length,o.length)}return null}function o(t){c.cookie=t+"=; Max-Age=-99999999;"}var c=t.document,n=e("html").data("school"),a=function(t){this.$select=e(t),this.init()};a.prototype.init=function(){var t=s("ccl-school");n&&(this.$select.find('option[value="'+t+'"]').attr("selected","selected"),t&&e("html").attr("data-school",t)),this.$select.change(function(t){e("html").attr("data-school",t.target.value),o("ccl-school"),i("ccl-school",t.target.value,7)})},e(c).ready(function(){e('[data-toggle="school"]').each(function(){new a(this)})})}(this,jQuery),function(t,e){"use strict";var i=t.document,s=function(t){this.$el=e(t),this.content=this.$el.attr("title"),this.$tooltip=e('<div id="ccl-current-tooltip" class="ccl-c-tooltip ccl-is-top" role="tooltip"><div class="ccl-c-tooltip__arrow"></div><div class="ccl-c-tooltip__inner">'+this.content+"</div></div>"),this.init()};s.prototype.init=function(){var t=this;this.$el.hover(function(e){t.$el.attr("title",""),t.$el.attr("aria-describedby","ccl-current-tooltip"),t.$tooltip.appendTo(i.body),CCL.reflow(t.$tooltip[0]);var s=t.$el.offset(),o=t.$el.outerWidth(),c=t.$tooltip.outerHeight();t.$tooltip.css({top:s.top-c+"px",left:s.left+o/2+"px"}),t.$tooltip.addClass("ccl-is-shown")},function(e){t.$el.attr("title",t.content),t.$el.attr("aria-describedby",""),t.$tooltip.removeClass("ccl-is-shown"),t.$tooltip.remove()})},e(i).ready(function(){e('[data-toggle="tooltip"]').each(function(){new s(this)})})}(this,jQuery),function(t,e){"use strict";var i,s,o=t.document,c=function(t){var i=this;return this.$el=e(t),this.$tabs=this.$el.find(".ccl-c-tab"),this.$tabContents=e(".ccl-c-tab__content"),this.$tabs.each(function(){var t=e(this);t.click(function(e){e.preventDefault();var s=t.data("target");i.setActive(s)})}),this};c.prototype.setActive=function(t){this.$tabs.removeClass("ccl-is-active"),this.$tabs.filter('[href="'+t+'"]').addClass("ccl-is-active"),this.$tabContents.removeClass("ccl-is-active"),this.$tabContents.filter(t).addClass("ccl-is-active")};var n=function(t){this.$el=e(t),this.callNumbers={},this.$form=this.$el.find("#call-number-search"),this.$input=this.$el.find("#call-num-input"),this.$submit=this.$el.find("#call-num-submit"),this.$marquee=this.$el.find(".ccl-c-wayfinder__marquee"),this.$callNum=this.$el.find(".ccl-c-wayfinder__call-num"),this.$wing=this.$el.find(".ccl-c-wayfinder__wing"),this.$floor=this.$el.find(".ccl-c-wayfinder__floor"),this.$subject=this.$el.find(".ccl-c-wayfinder__subject"),this.error={get:'<div class="ccl-c-alert ccl-is-error ccl-wayfinder__error"><button type="button" class="ccl-b-close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button><i class="ccl-b-icon alert" aria-hidden="true"></i> There was an error fetching call numbers.</div>',find:'<div class="ccl-c-alert ccl-is-error ccl-wayfinder__error"><button type="button" class="ccl-b-close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button><i class="ccl-b-icon alert" aria-hidden="true"></i> Could not find that call number. Please try again.</div>'},this.$errorBox=e(".ccl-error-box");var i=this;return e.getJSON(CCL.assets+"js/call-numbers.json").done(function(t){i.callNumbers=t,i.init()}).fail(function(t){console.log(t),this.$errorBox.append(this.error.get)}),this};n.prototype.init=function(){var t=this;this.$el.addClass("ccl-app-active"),this.$input.keyup(function(){""===e(this).val()?(t.$submit.attr("disabled",!0),t.$marquee.hide(),t.reset()):t.$submit.attr("disabled",!1)}),this.$form.submit(function(i){i.preventDefault(),t.reset();var s=t.$input.val();e(".ccl-wayfinder__error").remove(),t.$marquee.show(),t.$callNum.text(s),t.findRoom(s)})},n.prototype.getCallKey=function(t){var e,t=t.replace(/ /g,""),i=Object.keys(this.callNumbers);if(0!==i.length)return i.forEach(function(i){var s=i.replace(/ /g,"");t>=s&&(e=i)}),e},n.prototype.findRoom=function(t){t=t.toUpperCase();var s,o,c=this,n=this.getCallKey(t),a={};if(!n)return void this.throwFindError();e("html, body").animate({scrollTop:e(".ccl-c-search").offset().top}),a=this.callNumbers[n],this.$floor.text(a.floor),this.$wing.text(a.wing),this.$subject.text(a.subject),s=a.floor_int,o=a.room_int,this.$el.find('a[href="#floor-'+s+'"]').addClass("ccl-is-active"),"number"!=typeof o?o.forEach(function(t){c.$el.find("#room-"+s+"-"+t).addClass("ccl-is-active")}):this.$el.find("#room-"+s+"-"+o).addClass("ccl-is-active"),i.setActive("#floor-"+s)},n.prototype.reset=function(){this.$el.find('a[href*="#floor-"]').removeClass("ccl-is-active"),this.$el.find(".ccl-c-floor__room").removeClass("ccl-is-active")},n.prototype.throwFindError=function(){this.$el.find('a[href*="#floor-"]').removeClass("ccl-is-active"),this.$el.find(".ccl-c-floor__room").removeClass("ccl-is-active"),this.$floor.text(""),this.$wing.text(""),this.$subject.text(""),this.$errorBox.append(this.error.find)},e(o).ready(function(){e(".ccl-js-tabs").each(function(){i=new c(this)}),e(".ccl-js-wayfinder").each(function(){s=new n(this)})})}(this,jQuery);